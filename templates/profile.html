{% extends 'base.html' %}
{% block title %}Profile - EventApp{% endblock %}
{% block content %}
  <div class="welcome-section">
    <div class="d-flex justify-content-between align-items-center">
      <div>
        <h1 class="welcome-title">My Profile</h1>
        <p class="welcome-subtitle">Manage your account settings</p>
      </div>
      {% if current_user.is_admin %}
        <a href="{{ url_for('create_event') }}" class="btn btn-primary">
          <i class="fas fa-plus mr-2"></i>Create Event
        </a>
      {% endif %}
    </div>
  </div>
  <div class="row">
    <div class="col-md-8">
      <form method="post">
        <div class="row">
          <div class="col-md-6">
            <div class="form-group">
              <label for="first_name">First Name</label>
              <input type="text" class="form-control" id="first_name" name="first_name" value="{{ current_user.first_name or '' }}">
            </div>
          </div>
          <div class="col-md-6">
            <div class="form-group">
              <label for="last_name">Last Name</label>
              <input type="text" class="form-control" id="last_name" name="last_name" value="{{ current_user.last_name or '' }}">
            </div>
          </div>
        </div>
        
        <div class="form-group">
          <label for="username">Username</label>
          <input type="text" class="form-control" id="username" name="username" value="{{ current_user.username }}" required>
        </div>
        
        <div class="form-group">
          <label for="email">Email address</label>
          <input type="email" class="form-control" id="email" name="email" value="{{ current_user.email }}" required>
        </div>
        
        <div class="row">
          <div class="col-md-6">
            <div class="form-group">
              <label for="phone">Phone (optional)</label>
              <input type="tel" class="form-control" id="phone" name="phone" value="{{ current_user.phone or '' }}">
            </div>
          </div>
          <div class="col-md-6">
            <div class="form-group">
              <label for="timezone">Timezone</label>
              <select class="form-control" id="timezone" name="timezone">
                <option value="UTC" {% if current_user.timezone == 'UTC' %}selected{% endif %}>UTC</option>
                <option value="America/New_York" {% if current_user.timezone == 'America/New_York' %}selected{% endif %}>Eastern Time</option>
                <option value="America/Chicago" {% if current_user.timezone == 'America/Chicago' %}selected{% endif %}>Central Time</option>
                <option value="America/Denver" {% if current_user.timezone == 'America/Denver' %}selected{% endif %}>Mountain Time</option>
                <option value="America/Los_Angeles" {% if current_user.timezone == 'America/Los_Angeles' %}selected{% endif %}>Pacific Time</option>
                <option value="Europe/London" {% if current_user.timezone == 'Europe/London' %}selected{% endif %}>London</option>
                <option value="Europe/Paris" {% if current_user.timezone == 'Europe/Paris' %}selected{% endif %}>Paris</option>
                <option value="Asia/Tokyo" {% if current_user.timezone == 'Asia/Tokyo' %}selected{% endif %}>Tokyo</option>
                <option value="Asia/Shanghai" {% if current_user.timezone == 'Asia/Shanghai' %}selected{% endif %}>Shanghai</option>
                <option value="Asia/Singapore" {% if current_user.timezone == 'Asia/Singapore' %}selected{% endif %}>Singapore</option>
              </select>
            </div>
          </div>
        </div>
        
        <div class="row">
          <div class="col-md-6">
            <div class="form-group">
              <label for="country">Country</label>
              <input type="text" class="form-control" id="country" name="country" value="{{ current_user.country or '' }}">
            </div>
          </div>
          <div class="col-md-6">
            <div class="form-group">
              <label for="city">City</label>
              <input type="text" class="form-control" id="city" name="city" value="{{ current_user.city or '' }}">
            </div>
          </div>
        </div>
        
        <h5>Notification Preferences</h5>
        <div class="form-group">
          <div class="form-check">
            <input type="checkbox" class="form-check-input" id="email_notifications" name="email_notifications" {% if current_user.email_notifications %}checked{% endif %}>
            <label class="form-check-label" for="email_notifications">
              Email notifications
            </label>
          </div>
          <div class="form-check">
            <input type="checkbox" class="form-check-input" id="push_notifications" name="push_notifications" {% if current_user.push_notifications %}checked{% endif %}>
            <label class="form-check-label" for="push_notifications">
              Push notifications
            </label>
          </div>
          <div class="form-check">
            <input type="checkbox" class="form-check-input" id="time_format_24h" name="time_format_24h" {% if current_user.time_format_24h %}checked{% endif %}>
            <label class="form-check-label" for="time_format_24h">
              Use 24-hour time format
            </label>
          </div>
        </div>
        
        <h5>Privacy Settings</h5>
        <div class="form-group">
          <div class="form-check">
            <input type="checkbox" class="form-check-input" id="privacy_show_city" name="privacy_show_city" {% if current_user.privacy_show_city %}checked{% endif %}>
            <label class="form-check-label" for="privacy_show_city">
              Show city in public profile
            </label>
          </div>
          <div class="form-check">
            <input type="checkbox" class="form-check-input" id="privacy_show_full_name" name="privacy_show_full_name" {% if current_user.privacy_show_full_name %}checked{% endif %}>
            <label class="form-check-label" for="privacy_show_full_name">
              Show full name in public profile
            </label>
          </div>
        </div>
        
        <button type="submit" class="btn btn-primary">Update Profile</button>
      </form>
    </div>
    <div class="col-md-4">
      <div class="card">
        <div class="card-header">
          <h5>Account Information</h5>
        </div>
        <div class="card-body">
          <p><strong>Member since:</strong> {{ current_user.created_at.strftime('%B %d, %Y') }}</p>
          <p><strong>Account type:</strong> {% if current_user.is_admin %}Organizer{% else %}Attendee{% endif %}</p>
          <p><strong>Total RSVPs:</strong> {{ current_user.rsvps|length }}</p>
          {% if current_user.is_admin %}
            <p><strong>Events created:</strong> {{ current_user.events|length }}</p>
          {% endif %}
          <p><strong>Display name:</strong> {{ current_user.display_name }}</p>
        </div>
      </div>
    </div>
  </div>
{% endblock %}
